
<div class="container">
  <div class="row">
    <div class="col-md-8">
      <div>
        <h1><%= @boat.name %></h1>
      </div>
      <div>
        <% if @boat.photos? %>
          <% @boat.photos.each do |photo| %>
            <%= cl_image_tag photo.path, width: 200, height: 300, crop: :fill %>
          <% end %>
        <% end %>
        <%= link_to "Index", boats_path, class: "btn btn-danger" %>
      </div>
    </div>
  </div>
</div>

<!-- All bookings -->

<div class="">
  <h3>Existant bookings</h3>
  <% if @bookings.any? %>
    <% @bookings.each do |booking| %>
      <hr>
      <h4>Booking <%= booking.id %></h4>
      <span class="start-date badge-blue"><%= booking.start_at %></span>
      -
      <span class="end-date badge-blue"><%= booking.end_at %></span>
      <div><%= booking.user_review %></div>
      <div><%= booking.user_rating %></div>
      <%= simple_form_for [@boat, booking] do |f| %>
        <%= f.input :user_review %>
        <%= f.input :user_rating %>
        <%= f.button :submit %>
      <% end %>
    <% end %>
  <% else %>
    <p>No bookings yet</p>
  <% end %>

</div>

<!-- New Booking form -->
<div class="">
  <h1>New Booking</h1>
  <%= simple_form_for [@boat, @booking] do |f| %>
    <%= f.input :start_at, :as => :date %>
    <%= f.input :end_at, :as => :date %>
    <%= f.button :submit %>
  <% end %>
</div>

<!-- New Booking form -->

<div id="map" style="width: 100%; height: 400px;"></div>

<% content_for(:after_js) do %>
  <%= javascript_tag do %>
    $(document).ready(function() {
      var handler = Gmaps.build('Google');
      handler.buildMap({ internal: { id: 'map' } }, function() {
        markers = handler.addMarkers(<%= raw @hash.to_json %>);
        handler.bounds.extendWith(markers);
        handler.fitMapToBounds();
        if (markers.length == 0) {
          handler.getMap().setZoom(2);
        } else if (markers.length == 1) {
          handler.getMap().setZoom(14);
        }
      });
    });
  <% end %>
<% end %>

